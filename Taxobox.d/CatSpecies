local p = {}

local function getCat()
	if species then
		if unranked_phylum == 'Amoebozoa' then
	       return 'Уикипедия:Видове amoebozoa'
	    else
			if unranked_phylum == 'Rhizaria' then
				return 'Уикипедия:Видове rhizaria'
	        else
				if regnum then
					if regnum == 'Bacteria' then
						return 'Уикипедия:Видове бактерии'
					elseif regnum == 'Excavata' then
						return 'Уикипедия:Видове excavata'
					elseif regnum == 'Chromalveolata' then
						return 'Уикипедия:Видове chromalveolata'
					elseif regnum == 'Protista' then
						return 'Уикипедия:Видове протисти'
					elseif regnum == 'Plantae' then
						if divisio then
							if divisio == 'Pinophyta|Cycadophyta|Ginkgophyta|Gnetophyta' then
								return 'Уикипедия:Видове голосеменни растения'
							elseif divisio == 'Pteridophyta|Polypodiophyta|Lycopodiophyta' then
								return 'Уикипедия:Видове спорови растения'
							elseif divisio == 'Marchantiophyta|Hepatophyta|Hepaticophyta|Bryophyta|Anthocerotophyta' then
								return 'Уикипедия:Видове неваскуларни растения'
	                        elseif divisio == 'Charophyta|Chlorophyta' then
								return 'Уикипедия:Видове водорасли'
							else
								if classis then
	                                if classis == 'Liliopsida' then
										return 'Уикипедия:Видове едносемеделни растения'
									elseif classis == 'Magnoliopsida' then
										return 'Уикипедия:Видове двусемеделни растения'
	                                end
								end
							end
						end
						
						return 'Уикипедия:Видове растения'
					elseif regnum == 'Fungi' then
						return 'Уикипедия:Видове гъби'
					elseif regnum == 'Animalia' then
						if classis then
							if classis == 'Chondrichthyes' then
								return 'Уикипедия:Видове хрущялни риби'
							elseif classis == 'Actinopterygii' then
	                            return 'Уикипедия:Видове лъчеперки'
							elseif classis == 'Amphibia' then
	                            return 'Уикипедия:Видове земноводни'
							elseif classis == 'Reptilia' then
	                            return 'Уикипедия:Видове влечуги'
							elseif classis == 'Aves' then
	                            return 'Уикипедия:Видове птици'
							elseif classis == 'Mammalia' then
	                            return 'Уикипедия:Видове бозайници'
							else
								if phylum then
									if phylum == 'Arthropoda' then
										return 'Уикипедия:Видове членестоноги'
									elseif phylum == 'Platyhelminthes|Acanthocephala|Nematoda|Annelida' then
	                                    return 'Уикипедия:Видове червеи'
									elseif phylum == 'Mollusca' then
	                                    return 'Уикипедия:Видове мекотели'
									elseif phylum == 'Cnidaria' then
										return 'Уикипедия:Видове мешести'
	                                end
								end
							end
						end
						
						return 'Уикипедия:Видове животни'
					end
				else
					if domain == 'Archaea' then
						return 'Уикипедия:Видове археи'
	                else
						if false then
						   return 'Уикипедия:Видове вируси'
						end
					end
				end
			end
        	
        	return 'Уикипедия:Таксономия'
		end
	end	
end

local function count(categories)
	local count = 0
	for i=1, #categories do
		if mw.title.new('Категория:Уикипедия:Видове ' .. categories[i]).exists then
			count = count + mw.site.stats.pagesInCategory('Уикипедия:Видове ' .. categories[i], 'pages')
		end
	end
	
	return count
end

function p.plants()
	local plants = { 'спорови растения', 'голосеменни растения', 'едносемеделни растения', 'двусемеделни растения', 'неваскуларни растения', 'водорасли', 'растения' }
	
	return count(plants)
end

function p.animals()
	local animals = { 'бозайници', 'влечуги', 'земноводни', 'лъчеперки', 'мекотели', 'хрущялни риби', 'червеи', 'мешести', 'членестоноги', 'птици', 'животни' }
	
	return count(animals)
end

function p.all(frame)
	local all = { 'chromalveolata', 'бактерии', 'вируси', 'гъби', 'протисти', 'археи', 'amoebozoa', 'excavata', 'rhizaria' }

	return p.plants() + p.animals() + count(all)
end

return p
